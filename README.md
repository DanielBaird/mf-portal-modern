# Modernisation of MediaFlux Portals functionality

[MediaFlux](http://www.arcitecta.com/Products) includes a Portals
plugin that allows users to create web sites to access their data.

MediaFlux uses [GWT](http://www.gwtproject.org/) to create the
Portal pages.  GWT is a reasonable choice for producing
desktop-application-like web pages, but the HTML generated by
GWT is very resistant to styling via CSS.  CSS is the standard way
of formatting web content.

This project aims at re-imagining Portal output as clean, sensible
HTML.


## Strategy

I've captured the pages generated by MediaFlux for the cat-based
demonstration portal.


### Isolate page components

1. Identified page "components", for example:
  - **Header** is the page header
  - **ListItem** is an item displayed in a list of items
1. Extracted HTML for each "component" into separate files
1. Replaced each component with a reference to the file containing
   the extracted HTML for that component
1. Written a shell script to re-assemble the page by starting with
   the main page and replacing file references with the HTML from
   that component file
1. Verifying the assembled page looks like the original

This produces a set of files that each represent a page component.


### Replace components with clean versions

With each component file, I replaced the millions-of-nested-tables
HTML generated by GWT with clean, simple HTML.  The functionality
of the page is verified by re-assembling the page out of components.


## Repo Structure


### original HTML

[```original-gwt-html```](original-gwt-html) directory contains raw
html generated by the current portal plugin, for several Cat Portal
pages including the cat list page.


### Componentised versions

[```html-components```](html-components) directory contains three
componentised versions of the cat list page.

The components extracted are indicated in this diagram:

![components](images/components-01.png)

These are my guesses at page entities managed by the GWT code.

Each of the three componentised versions includes a ```cat-list.source```
file that contains the page layout and shows where to include the
component files.  A shell script ```convert.sh``` (for
[bash](https://en.wikipedia.org/wiki/Bash_(Unix_shell))) inserts the
component files into the right places, to produce
```cat-list.source.html``` which is the complete page (this output
is aready in the repo, so you don't need to run the script to see the
result).


#### Original version, split into components

[```html-components/old```](html-components/old) contains the
original GWT generated HTML, split across several files.  The HTML
is not changed from GWT's generated code, aside from splitting out
components, and a minor path tweak to the Font Awesome path so that
it continues to work without a MF server.

HTML for each component is in the
[```./components```](html-components/old/components) directory.


#### New version, revising component structure

[```html-components/new```](html-components/new) contains the same
files as the componentised original version, but with new content.

New HTML for each component is in the
[```./components```](html-components/new/components) directory.

Here's a side-by-side comparison of the menubar component:

<iframe style="width: 40%; height: 300px; float: left;"
	src="https://raw.githubusercontent.com/DanielBaird/mf-portal-modern/gh-pages/html-components/old/components/menubar.html"
/>
<iframe style="width: 40%; height: 300px; float: right;"
	src="https://raw.githubusercontent.com/DanielBaird/mf-portal-modern/gh-pages/html-components/new/components/menubar.html"
/>




